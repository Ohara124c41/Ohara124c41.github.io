---
layout: post
title: "Evolving GRN–Metabolic Networks: Signal Transduction under Selection"
subtitle: "Universal Biology: How to _design life?_"
author: "Christopher O’Hara"
header-style: text
tags:
  - Systems
  - Biology
  - GRN
  - Metabolism
  - Evolution
---

**Notebook:**  
Code and figures are available in the companion Jupyter notebook:  
[OHARA_Universal_Biology_GRN_Metabolic.ipynb](https://github.com/Ohara124c41/GRN-Metabolic_Network-Dynamics/blob/main/OHARA_Universal_Biology_GRN_Metabolic.ipynb)

---

### Introduction

This post couples a **gene regulatory network (GRN)** with a **metabolic network** and applies evolutionary search to investigate how **signal-transduction–like behavior** can emerge under selection for homeostasis. In algorithmic terms, **evolutionary algorithms (EAs)** form a broad family of population-based stochastic optimizers inspired by natural selection (selection, variation, and inheritance). **Genetic algorithms (GAs)** are a canonical **subset** of EAs characterized by fixed-length genotypes, fitness-proportionate or rank-based selection, and variation via **mutation** and **crossover** acting on the genotype. Put succinctly:

- **EA ⊃ GA.** Every GA is an EA, but not every EA is a GA.  
- GA emphasizes recombination and mutation on encoded chromosomes; other EA subfamilies (evolution strategies, genetic programming, differential evolution) use different representations and operators.  
- The implementation used here is an **EA variant** that adopts GA-style **selection** and **mutation** to evolve GRN and metabolic edges and their couplings; **crossover is not essential** in this minimal setup. The fitness signal is defined by proximity to homeostatic targets for both gene expression and substrate concentrations.

**GRN Diagram:**  
![GRN Diagram](https://github.com/Ohara124c41/Ohara124c41.github.io/blob/master/_posts/img/GRN.jpg?raw=true)


---

### Model

**Composite network.** The GRN comprises genes connected by directed regulatory edges: activation (positive) and inhibition (negative), including self-regulation on selected nodes. The metabolic network comprises substrates connected by directed reaction edges, with an explicit **exchange pathway** modeling bidirectional diffusion or transport with the environment. A **signal-coupling** from metabolites back to genes closes the loop, enabling substrates to modulate gene expression (a proxy for signal transduction).

Key structural elements:

1. **GRN topology.** Directed activation and inhibition, with optional self-loops.
2. **Metabolic topology.** Directed reactions and specific exchange links to the environment.
3. **Signal coupling (metabolism → regulation).** Selected metabolites influence gene expression levels.

---

### Fitness Objective and Evolutionary Setting

- **Objective.** Maintain both **gene expression** levels and **substrate concentrations** near a setpoint of **0.5**.  
- **Environment change factor.** **0.02** per step to induce mild stochastic drift.  
- **Mutation rate (GRN + metabolism).** **0.05** on edges/weights/links.  
- **Signal-coupling mutation probability.** **0.10** to accelerate exploration of signaling configurations.  
- **Generational horizon.** **1000** generations.

The parameterization balances variation (mutation) and stability (environment), enabling gradual adaptation with occasional regressions and recoveries.

---

### Simulation Procedure

The simulation represents GRN and metabolic networks as matrices and adjacency structures. Each generation performs:

1. **Environmental perturbation.** Apply stochastic changes to substrate concentrations; apply exchange on designated metabolites.  
2. **Metabolic update.** Advance substrates along reaction and exchange edges.  
3. **Regulatory update.** Map metabolite states to gene expression via signal couplings; update gene levels accordingly.  
4. **Mutation.** Independently mutate GRN edges (sign/strength/presence), metabolic reactions, and signal couplings; use the higher mutation rate on signaling links to broaden search.  
5. **Fitness evaluation.** Compute deviation of all gene and substrate states from the **0.5** setpoint; lower deviation corresponds to higher fitness.  
6. **Selection and record.** Retain fitter configurations (per the EA scheme), log fitness history, GRN state matrices (initial/final), and final GRN/metabolic graphs.

---

### Representative Outputs

#### Fitness over Generations
The fitness trace over **1000** generations typically exhibits **oscillatory** behavior: gradual improvements punctuated by sudden drops from disruptive mutations or unfavorable perturbations, followed by recovery as selection reinforces compensatory structures. This pattern is consistent with a rugged fitness landscape under mild environmental drift.

![Fitness Diagram](https://github.com/Ohara124c41/Ohara124c41.github.io/blob/master/_posts/img/GRN01.jpg?raw=true)



#### GRN State: Initial vs Final (Heatmaps)
Initial GRN matrices are relatively sparse. After evolution, the final matrices show **densification** and redistribution of activation/inhibition strengths, reflecting emergent regulatory motifs that stabilize system outputs near the homeostatic target.


![Heatmaps](https://github.com/Ohara124c41/Ohara124c41.github.io/blob/master/_posts/img/GRN02.jpg?raw=true)


#### Final Network Graphs
Final **GRN** and **metabolic** graphs encode node states by color (low to high expression/concentration). The distributions reveal how regulatory structure biases metabolic flows and how metabolite landscapes, in turn, shape regulatory outputs through the signal-coupling, making the **regulation–metabolism feedback** explicit.

![Output Diagram](https://github.com/Ohara124c41/Ohara124c41.github.io/blob/master/_posts/img/GRN03.jpg?raw=true)


---

### Parameter Effects (Qualitative)

- **Environment change factor (0.02).** Encourages **gradual** evolutionary responses instead of volatile shifts.  
- **Mutation rate (0.05).** Provides sufficient diversity to avoid stagnation without destabilizing the population.  
- **Signal mutation (0.10).** Prioritizes exploration of signal transduction links, increasing variance but enabling discovery of robust homeostatic configurations.

---

### Interpretation

Selection for homeostasis in a coupled GRN–metabolic system tends to **indirectly** produce **signal-transduction–like pathways**. Even without direct optimization of signaling per se, co-evolution of regulation and metabolism yields **robust motifs** that buffer perturbations. The observed fitness trajectories, GRN densification, and end-state metabolite distributions jointly support this interpretation.

---

### Appendix: Additional Runs

Additional end-state graph sets (GRN and metabolic) in the notebook illustrate stochastic variability. Different mutation histories lead to distinct, yet functional, homeostatic solutions with comparable fitness.

---

### Reproducibility Notes

- **Generations:** 1000  
- **Setpoint (genes and substrates):** 0.5  
- **Environment change factor:** 0.02  
- **Mutation rate (GRN + metabolism):** 0.05  
- **Signal-coupling mutation probability:** 0.10  
- **Recorded artifacts:** fitness histories; initial/final GRN matrices; final GRN and metabolic graphs

Refer to the companion notebook for full code and figure generation:  
[OHARA_Universal_Biology_GRN_Metabolic.ipynb](https://github.com/Ohara124c41/GRN-Metabolic_Network-Dynamics/blob/main/OHARA_Universal_Biology_GRN_Metabolic.ipynb)

---

### Conclusion

A minimal evolutionary algorithm acting on a coupled GRN–metabolic system, with fitness defined by homeostatic proximity to a common setpoint, reliably yields **adaptive regulatory structures** and **stabilized metabolite landscapes**. The results demonstrate how **complex regulatory behavior can emerge as a byproduct** of selection for stability in interconnected biological subsystems, aligning with the broader view that GAs are one practical instantiation within the more general EA framework used here.
